---
title: "Data Analysis Task"
output:
  html_document:
    df_print: paged
author: "Dandara Sousa"
---


```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(lubridate)
theme_set(theme_bw())
```

### O que é o dado?

Existem 9 variáveis nos dados sendo elas:

* session_id : Um id único identificando sessões individuais
* search_index : Um contador de buscas em uma mesma sessão ordenado cronologicamente
* session_start_timestamp: O timestamp que a sessão iniciou
* session_start_date : A data e hora que a sessão iniciou
* group : O grupo que pode ser "a" ou "b"
* results : A quantidade de resultados que a busca retornou
* num_clicks : O número de páginas que o usuário visitou a partir da busca
* first_click : A posição do link da página visitada no mecanismo de busca de páginas
* session_length : A duração em segundos da sessão

```{r ETL}
events <- read_csv("../data/search_data.csv")

events <- events %>% slice(1:5e4) # Útil para testar código em dados pequenos. Comente na hora de processá-los para valer.

#events <- events %>% 
#    group_by(session_id) %>% 
#    arrange(timestamp) %>% 
#    mutate(search_index = cumsum(action == "searchResultPage"), # contador de buscas na sessão.
#           date = ymd_hms(timestamp))  %>% 
#    ungroup()

#glimpse(events)
```


### O que queremos saber sobre ele?

#### Qual a nossa taxa diária de clickthrough rate? Como isso varia entre os grupos?
O Discovery Department da Wikimedia define `clickthrough rate` como a proporção de sessões onde o usuário clicou em um dos resultados mostrados.
```{r}
#criar coluna clickthrough
events <- events %>%
    mutate(clickthrough_rate = num_clicks/results)

events %>%
    ggplot(aes(num_clicks,results)) +
    geom_jitter(alpha = .2) + 
    #geom_hline(yintercept = , linetype='dashed')+
    facet_wrap(~group)
```


#### Quais resultados as pessoas tendem a clicar primeiro? Como isso muda no dia-a-dia?
    
#### Qual a nossa taxa diária de zero results rate? Como isso varia entre os grupos?
O Discovery Department da Wikimedia define `zero results rate` como a proporção de buscas que retornou 0 resultados.
```{r}
#criar coluna zeroresults
events <- events %>%
    group_by(group) %>%
    mutate(zero_results = (results == 0)/n())
```

#### Considere a duração de cada sessão aproximadamente o tempo entre o primeiro e último evento de uma sessão. Escolha uma variável do conjunto de dados e descreva a relação com o tamanho da sessão. Visualise o relacionamento.

```{r}
#criar coluna session_duration
```

